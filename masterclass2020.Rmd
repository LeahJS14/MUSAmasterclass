---
title: "MUSA Masterclass 2020"
author: "Kyle Walker"
output: 
  html_document: 
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Getting started

### Installing packages and dependencies

To get started with mapboxapi, you'll need to first install some packages.  At the moment, mapboxapi has been submitted to CRAN but is currently under review; so for now, we will install from GitHub.  

```{r}
install.packages("remotes")

remotes::install_github("walkerke/mapboxapi")

```

If you've been working with R Spatial packages before, installation should go smoothly.  If you are new to R/R Spatial, you may need to do some configuration prior to successful installation of the package.  mapboxapi depends heavily on the [sf](https://github.com/r-spatial/sf) package for spatial data processing in R.  On Ubuntu, use the following commands in a terminal to install required dependencies: 

```bash
sudo add-apt-repository ppa:ubuntugis/ubuntugis-unstable
sudo apt-get update
sudo apt-get install -y libudunits2-dev libgdal-dev libgeos-dev libproj-dev 
```

mapboxapi also uses the [protolite](https://github.com/jeroen/protolite) package for interacting with Mapbox vector tiles and the [magick](https://github.com/ropensci/magick) package for image processing and display.  On Ubuntu, install dependencies with:

```bash
sudo apt-get install -y libprotobuf-dev protobuf-compiler libmagick++-dev
```

Instructions for other Linux distributions can be found on the package websites linked above.  


```

## Academic research & open source software


## Spatial data science in R


## The Mapbox platform


## {mapboxapi}: Mapbox tools for spatial data science


## Mapbox Search API

```{r}
library(mapboxapi)

penn <- mb_geocode("210 S 34th St, Philadelphia PA")

penn
```
## Mapbox Maps API

### Using the Static Tiles API in Leaflet

```{r}
library(leaflet)

leaflet() %>%
  addMapboxTiles(style_id = "streets-v11",
                 username = "mapbox") %>%
  addMarkers(lng = penn[1], lat = penn[2])

```




## Mapbox Navigation APIs

### Isochrones

```{r}
library(mapview)
mapviewOptions(platform = "mapdeck")
# 
# penn_isochrones <- mb_isochrone(penn, 
#                                 profile = "walking",
#                                 time = c(5, 10, 15))

colors = rev(viridisLite::viridis(3))

leaflet() %>%
  addMapboxTiles(style_id = "light-v10",
                 username = "mapbox") %>%
  addPolygons(data = penn_isochrones,
              color = colors,
              fillColor = colors,
              fillOpacity = 0.5, 
              opacity = 1, 
              weight = 0.2)
```

### Routing




## Mapbox 



<style>

h1, h2, h3 {
  color: #035004; 
  font-family: "Verdana"
}

body {
  font-family: "Verdana"
}

a {
  color: #1a730f; 
}

.inverse {
  background-color: #035004; 

}

.list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
    z-index: 2;
    color: #fff;
    background-color: #035004;
    border-color: #035004;
}


</style>


